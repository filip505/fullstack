{"version":3,"sources":["../../src/helper/controller.decorator.js"],"names":["getValues","method","sufix","descriptor","middleware","value","middlewares","get","target","property","post","put","update","dele","patch","createMiddleware","controller","prefix","MyClass","router","Router","elements","Object","values","getOwnPropertyDescriptors","prototype","element","m","reduce","prev","curr","bind"],"mappings":"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","sourcesContent":["import Router from 'koa-router'\n\nfunction getValues(method, sufix, descriptor, middleware) {\n    descriptor.value = {\n        method,\n        sufix: sufix ? sufix : '/',\n        value: descriptor.value,\n        middlewares: middleware ? descriptor.value.middlewares ? [...descriptor.value.middlewares, middleware] : [middleware] : null\n    }\n    return descriptor\n}\n\nconst get = (sufix) => (target, property, descriptor) => getValues('get', sufix, descriptor)\nconst post = (sufix) => (target, property, descriptor) => getValues('post', sufix, descriptor)\nconst put = (sufix) => (target, property, descriptor) => getValues('put', sufix, descriptor)\nconst update = (sufix) => (target, property, descriptor) => getValues('update', sufix, descriptor)\nconst dele = (sufix) => (target, property, descriptor) => getValues('delete', sufix, descriptor)\nconst patch = (sufix) => (target, property, descriptor) => getValues('patch', sufix, descriptor)\n\nconst createMiddleware = (middleware) => (target, property, descriptor) => {\n    descriptor.value.middlewares = descriptor.value.middlewares ?\n        [...descriptor.value.middlewares, middleware] : [middleware]\n    return descriptor\n}\n\nfunction controller(prefix) {\n    return function (MyClass) {\n        return function () {\n            const router = new Router(prefix)\n            const elements = Object.values(Object.getOwnPropertyDescriptors(MyClass.prototype))\n            for (let element of elements) {\n                const { method, sufix, value } = element.value\n                let m = value\n\n\n                if (method) {\n                    if (element.value.middlewares) {\n                        m = element.value.middlewares.reduce((prev, curr) => {\n                            return curr.bind(null, prev)();\n                        }, value)\n                    }\n                    router[method](prefix + sufix, m)\n                }\n            }\n            return router\n        }\n    }\n}\n\nexport { get, post, controller, put, update, dele, patch }"],"file":"controller.decorator.js"}